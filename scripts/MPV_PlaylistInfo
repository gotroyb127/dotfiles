#!/bin/sh

neednl=n
Echo() {
	[ "$neednl" = y ] && {
		echo
		neednl=n
	}
}
Print() {
	S=$(Player.sh playlist-info) || {
		r=$?
		Echo
		return $r
	}
	LF_Clear
	printf "%s\t" "$S"
	neednl=y
}
Wait() {
	r=$?
	[ $r != 0 ] &&
		ret="[$r] "
	Echo
	printf '%s%s' "$ret" 'Waiting... : '
	read ans
	case $ans in
	(q*)
		exit 0
	;;
	(c*)
		clear
		Wait
	;;
	(r*)
		exec "$0" "$@"
	;;
	esac
}
Main() {
	while true
	do
		Print || Wait
		sleep .93
	done
}

trap 'neednl=y; Wait; Main' INT

Main
